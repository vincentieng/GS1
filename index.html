<html>
<head>
<title>Demo page for https://github.com/gs1/GS1DigitalLinkToolkit.js</title>
<script src="https://cdn.jsdelivr.net/npm/vue"></script>
<script src="src/GS1DigitalLinkToolkit.js"></script>
<style type="text/css">
body { background-color: #FFFFFF; font-size: 1en; font-family: Arial, Helvetica, Geneva, sans-serif; }
h1 { text-align: center; }
table { width: 100%; }
td.label { width: 14em; }
td.demobutton { width: 4em; }
td.demobutton2 { width: 8em; }
td.charCount {text-align: right;}
tr.elementString { background-color: #CCCCFF;}
tr.options { background-color: #EEEEEE;}
tr.digitalLink { background-color: #FFD9CC;}
tr.compressedDigitalLink { background-color: #FFD999;}
tr.spacer {background-color: #FFFFFF; height: 1en;}
tr.whiterow {background-color: #FFFFFF; height: 1em;}
input.whiterow {background-color: #FFFFFF; font-size: 1em;}
tr.errorMessage { background-color: #FF0000; color: #FFFFFF;}
input.elementString { background-color: #CCCCFF; font-size: 1em;}
input.digitalLink { background-color: #FFD9CC; font-size: 1em;}
input.compressedDigitalLink { background-color: #FFD999; font-size: 1em;}
textarea.structuredArrayOutput { background-color: #FFFFFF; font-size: 1em; width: 100%; height: 3em; }
textarea.semanticOutput { background-color: #FFFFFF; font-size: 1em; width: 100%; height: 9em; }
textarea.errorMessage { background-color: #FFEEEE; font-size: 1em; height: 3em; width: 100%;}
select.elementString { background-color: #CCCCFF; font-size: 1em}
select.digitalLink { background-color: #FFD9CC; font-size: 1em}

input {width: 100%;}
</style>
</head>
<body>
<h1>Simple demo page for GS1DigitalLinkToolkit.js</h1>
<p>This simple demo page can be further developed to add further features.
<br>It uses <a href="https://github.com/gs1/GS1DigitalLinkToolkit.js" target="_blank">GS1DigitalLinkToolkit.js</a> to translate between GS1 element strings and GS1 Digital Link URI syntax.
<br>It uses <a href="https://vuejs.org/" target="_blank">vue.js</a> to update the Web page in real time, all client-side.</p>
&nbsp;<br/>
<hr/>
&nbsp;<br/>

<div id="app1">
<table>
<tr class="elementString"><td class="label">Input: Example of Link</td><td><input class="elementString" type="text" v-model="elementStringInput"></td><td class="demobutton"><input class="elementString" type="button" value="Example" @click="demo1"></td></tr>

<h2>Compress GS1 Digital Link</h2>
<table>
<tr class="digitalLink"><td class="label">Input: Uncompressed GS1 Digital Link URI</td><td><input id="uncompressedDigitalLinkInput" class="digitalLink" type="text" v-model="uncompressedDigitalLinkInput"></td><td class="charCount">{{uncompressedDigitalLinkInput.length}}</td></tr>
<tr class="compressedDigitalLink"><td class="label">Output: Compressed GS1 Digital Link URI</td><td><input id="compressedDigitalLink" class="compressedDigitalLink" type="text" v-model="compressedDigitalLink"></td><td class="charCount">{{compressedDigitalLink.length}}</td></tr>
<tr class="options">
	<td class="label">Options</td>
	<td colspan="3">Compress non-GS1 key=value pairs from URI query string <select  class="compressOtherKeyValuePairs" v-model="compressOtherKeyValuePairs"><option value="true">Yes</option><option value="false">No</option></select></td>
</tr>
<tr class="errorMessage" v-show="error3 !== ''"><td class="label">Error:</td><td colspan="2"><textarea class="errorMessage" v-model="error3"></textarea></td></tr>
</table>
&nbsp;<br/>
<hr/>
&nbsp;<br/>
<h2>Decompress GS1 Digital Link</h2>
<table>
<tr class="compressedDigitalLink"><td class="label">Input: Compressed GS1 Digital Link URI</td><td><input id="compressedDigitalLinkInput2" class="compressedDigitalLink" type="text" v-model="compressedDigitalLinkInput2"></td><td class="charCount">{{compressedDigitalLinkInput2.length}}</td></tr>
<tr class="digitalLink"><td class="label">Output: Uncompressed GS1 Digital Link URI</td><td><input id="uncompressedDigitalLinkOutput" class="digitalLink" type="text" v-model="uncompressedDigitalLinkOutput"></td><td class="charCount">{{uncompressedDigitalLinkOutput.length}}</td></tr>
<tr class="structuredArray"><td class="label">Output: Structured Array</td><td colspan="2"><textArea class="structuredArrayOutput" class="digitalLink" v-model="structuredArrayOutput"></td></tr>
<tr class="errorMessage" v-show="error4 !== ''"><td class="label">Error:</td><td colspan="2"><textarea class="errorMessage" v-model="error4"></textarea></td></tr>
</table>

</div>
<script language="javascript">
var digitalLinkInput = "";
var compressedDigitalLinkInput = "";
var compressedDigitalLinkInput2 = "";
var uncompressedDigitalLinkInput = "";
var compressedDigitalLink = "";
var uncompressedDigitalLink = "";
var elementStringInput = "";
var uncompressedDigitalLinkOutput = "";
var structuredArrayOutput="";

var testDigitalLinkInput="";
var testElementStringsInput="";
var detected="";
var fragment="";
var queryString="";
var relevantPath="";
var uriStem="";


var error1 = "";
var error2 = "";
var error3 = "";
var error4 = "";
var error5 = "";
var shortnames="true";
var uristem="http://example.org";
var useOptimisations = "false";
var uncompressedPrimary = "false";
var compressOtherKeyValuePairs="false";
var brackets="true";
var gs1dlt = new GS1DigitalLinkToolkit();




	var app1 = new Vue({
		el: "#app1",
		data : {
			elementStringInput : elementStringInput,
			digitalLinkInput : digitalLinkInput,
			compressedDigitalLinkInput : compressedDigitalLinkInput,
			compressedDigitalLinkInput2 : compressedDigitalLinkInput2,
			uncompressedDigitalLinkInput : uncompressedDigitalLinkInput,
			testDigitalLinkInput : testDigitalLinkInput,
			testElementStringsInput : testElementStringsInput,
			error1: error1,
			error2: error2,
			error3: error3,
			error4: error4,
			error5: error5,
			gs1dlt : gs1dlt,
			shortnames: shortnames,
			uristem: uristem,
			useOptimisations : useOptimisations,
			uncompressedPrimary : uncompressedPrimary,
			brackets: brackets,
			compressOtherKeyValuePairs : compressOtherKeyValuePairs
		},
		computed : {
			digitalLinkOutput : function() {
				if (this.elementStringInput !== "") {
					try {
						this.error1="";
						return gs1dlt.gs1ElementStringsToGS1DigitalLink(this.elementStringInput, (this.shortnames =="true"), this.uristem);
					} catch(err) {
						this.digitalLinkOutput="";
						this.error1=err+"\n"+err.stack;
						return "";
					}
				} else {
				return "";
				}
			},
			compressedDigitalLinkOutput : function() {
				if (this.elementStringInput !== "") {
					try {
						this.error1="";
						return gs1dlt.gs1ElementStringsToCompressedGS1DigitalLink(this.elementStringInput, (this.shortnames =="true"), this.uristem, (this.uncompressedPrimary=="true") , (this.useOptimisations=="true") );
					} catch(err) {
						this.digitalLinkOutput="";
						this.error1=err+"\n"+err.stack;
						return "";
					}
				} else {
				return "";
				}
			},
			elementStringOutput : function() {
				if (this.digitalLinkInput !== "") {
					try {
						this.error2="";
						return gs1dlt.gs1digitalLinkToGS1elementStrings(this.digitalLinkInput, (this.brackets =="true"));
					} catch(err) {
						this.elementStringOutput="";
						this.error2=err+"\n"+err.stack;
						return "";
					}
				}
				if (this.compressedDigitalLinkInput !=="") {
					try {
						this.error2="";
						return gs1dlt.gs1compressedDigitalLinkToGS1elementStrings(this.compressedDigitalLinkInput, (this.brackets == "true"));
					} catch(err) {
						this.elementStringOutput="";
						this.error2=err+"\n"+err.stack;
						return "";
					}

				}
				if ((this.digitalLinkInput == "") && (this.compressedDigitalLinkInput =="")) {
					return "";
				}


			},
			compressedDigitalLink : function() {
				if (this.uncompressedDigitalLinkInput !== "") {
					try {
						this.error3="";
						return gs1dlt.compressGS1DigitalLink(this.uncompressedDigitalLinkInput,(this.shortnames =="true"),this.uristem,(this.uncompressedPrimary=="true"),(this.useOptimisations=="true"),(this.compressOtherKeyValuePairs=="true"));
					} catch(err) {
						this.error3=err+"\n"+err.stack;
						return "";
					}


				} else {
					return "";
				}
			},
			uncompressedDigitalLinkOutput : function() {
				if (this.compressedDigitalLinkInput2 !== "") {
					try {
						this.error4="";
						return gs1dlt.decompressGS1DigitalLink(this.compressedDigitalLinkInput2,(this.shortnames =="true"),this.uristem)
					} catch(err) {
						this.error4=err+"\n"+err.stack;
						return "";
					}
				} else {
					return "";
				}
			},
			structuredArrayOutput : function() {
				if (this.compressedDigitalLinkInput2 !== "") {
					try {
						this.error4="";
						return JSON.stringify(gs1dlt.decompressGS1DigitalLinkToStructuredArray(this.compressedDigitalLinkInput2));
					} catch(err) {
						this.error4=err+"\n"+err.stack;
						return "";
					}
				} else {
					return "";
				}

			},
			analysis: function() {

				if (this.testDigitalLinkInput !== "") {
				 return gs1dlt.analyseURI(this.testDigitalLinkInput,false);
				} else {
				 return null;
				}
			},
			fragment: function() {
				if (this.analysis !== null) {
					return this.analysis.fragment;
				} else {
					return "";
				}
			},
			queryString: function() {
				if (this.analysis !== null) {
					return this.analysis.queryString;
				} else {
					return "";
				}
			 },
			relevantPath: function() {
				if (this.analysis !== null) {
					return this.analysis.pathComponents;
				} else {
					return "";
				}
			},
			uriStem: function() {
				if (this.analysis !== null) {
					return this.analysis.uriStem;
				} else {
					return "";
				}
			},
			detected: function() {
				if (this.analysis !== null) {
					return this.analysis.detected;
				} else {
					return "";
				}
			},
			uncompressedPath: function() {
				if (this.analysis !== null) {
					return this.analysis.uncompressedPath;
				} else {
					return "";
				}
			},
			compressedPath: function() {
				if (this.analysis !== null) {
					return this.analysis.compressedPath;
				} else {
					return "";
				}
			},
			structuredOutput: function() {
				if (this.testDigitalLinkInput !== "") {
				 return JSON.stringify(gs1dlt.analyseURI(this.testDigitalLinkInput,true).structuredOutput);
				} else {
				 return "";
				}
			},

			semanticOutput : function() {
				if (this.testDigitalLinkInput !== "") {
				 return JSON.stringify(gs1dlt.analyseURIsemantics(this.testDigitalLinkInput,true),null,2);
				} else {
					if (this.testElementStringsInput !== "") {
						let dl = gs1dlt.gs1ElementStringsToGS1DigitalLink(this.testElementStringsInput, (this.shortnames =="false"), "");
						return JSON.stringify(gs1dlt.analyseURIsemantics(dl,true),null,2);
					} else {
						return "";
					}
				}
			},

			elementStringsOutput: function() {
				if (this.testDigitalLinkInput !== "") {
				 return gs1dlt.analyseURI(this.testDigitalLinkInput,true).elementStringsOutput;
				} else {
				 return "";
				}
			}


		},
		methods : {
			demo1 : function() {
				this.elementStringInput="http://example.org/gtin/05412345000013/lot/ABC%26%2B123?expdt=1903061658";
			},
			demo2 : function() {
				this.digitalLinkInput="https://example.org/gtin/054123450013/lot/ABC%26%2B123?3103=000189&3923=2172";
			},
			demo3 : function() {
				this.compressedDigitalLinkInput="http://example.org/ENEGFDTK2LJmYgYAF6ckaEPgCE7CjmsE0";
			},
			copy3 : function() {
				this.digitalLinkInput="";
				this.compressedDigitalLinkInput=this.compressedDigitalLinkOutput;

			},
			copy4 : function() {
				this.compressedDigitalLinkInput="";
				this.digitalLinkInput=this.digitalLinkOutput;
			}

		}
	});


</script>

</body>
</html>
